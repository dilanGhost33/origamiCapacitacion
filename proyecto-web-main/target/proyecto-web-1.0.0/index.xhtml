<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
    
    <h:head>
        <title>Ingreso de proyecto</title>
    </h:head>
    <h:body>
        <center>
            <p:outputLabel value="Ingreso de proyecto" style="font-weight: bolder; font-size: 14px"/>
        </center>
        <p:commandButton value="Registrar pregunta" oncomplete="PF('dlgPregunta').show()" 
                             style="float: right" icon="pi pi-plus" update="frmPregunta"/>
        <p:commandButton value="Crear Encuesta" actionListener="#{preguntaMB.crearEncuesta()}" 
                             style="float: right; background-color: red" icon="pi pi-plus" update="frmPregunta"/>
        <br></br>
        <br></br>
    </h:body>
        <h:form id="frmPreguntas">
                <br></br>
                <br></br>
            <p:dataTable id="dtPreguntas" value="#{preguntaMB.preguntas}" var="p">
                <p:column headerText="Estado">
                    #{p.estado}
                </p:column>
                <p:column headerText="Tipo">
                    #{p.tipo}
                </p:column>
                <p:column headerText="Requerida">
                    <center>
                    <p:outputLabel value="SI" rendered="#{p.requerida}" />
                    <p:outputLabel value="NO" rendered="#{!p.requerida}" />
                    </center>
                </p:column>
                <p:column headerText="Pregunta">
                    #{p.pregunta}
                </p:column>
                <p:column headerText="**">
                    <p:commandButton value="Editar" icon="pi pi-pencil"
                                     styleClass="rounded-button"
                                     actionListener="#{preguntaMB.editarPregunta(p)}"
                                     oncomplete="PF('dlgPregunta').show()"
                                     update="frmPregunta"/>
                    <p:spacer width="5" />
                    <p:commandButton value="Respuestas" icon="pi pi-plus"
                                     styleClass="rounded-button"
                                     actionListener="#{preguntaMB.cargarRespuestas(p)}"
                                     oncomplete="PF('dlgRespuesta').show()"
                                     update="frmRespuestas, frmRespuesta"/>
                </p:column>
                

            </p:dataTable>
                
            
        </h:form>
            <br></br>

    <p:dialog id="dlgPregunta" widgetVar="dlgPregunta" header="Registro de preguntas "
        modal="true" width="600">
        <h:form id="frmPregunta">
            
            <p:panelGrid columns="2">
                <f:facet name='header'>
                     <h:panelGroup>
                    <p:outputLabel value="Pregunta" style="float: left"/> 
                    <p:inputTextarea rows="5" value="#{preguntaMB.pregunta.pregunta}" style="width: 100%"/>
                
                </h:panelGroup> 
                </f:facet >
               
                
                <h:panelGroup>
                    <p:outputLabel value="Tipo de pregunta"/> <br></br>
                    <p:selectOneMenu value="#{preguntaMB.pregunta.tipo}" style="width: 100%">
                        <f:selectItem itemLabel="Pregunta" itemValue="Pregunta"/>
                        <f:selectItem itemLabel="Opcion Multiple" itemValue="Opcion"/>
                        <f:selectItem itemLabel="Categorias" itemValue="Categorias"/>
                    </p:selectOneMenu>

                
                </h:panelGroup> 
                <h:panelGroup>
                    <p:outputLabel value="Tipo de pregunta"/> <br></br>
                    <p:selectOneMenu value="#{preguntaMB.pregunta.estado}" style="width: 100%">
                        <f:selectItem itemLabel="Activo" itemValue="Activo"/>
                        <f:selectItem itemLabel="Inactivo" itemValue="Inactivo"/>
                    </p:selectOneMenu>

                
                </h:panelGroup>
                <h:panelGroup>
                    <p:outputLabel value="Es obligatorio"/> <br></br>
                    <p:selectBooleanCheckbox value="#{preguntaMB.pregunta.requerida}" style="width: 100%" />
                
                </h:panelGroup>
                <f:facet name='footer'>
                    <center> 
                        <p:commandButton value="Guardar" styleClass="rounded-button"
                                         style="background-color: green"
                                         actionListener="#{preguntaMB.guardarPregunta()}"
                                         oncomplete="PF('dlgPregunta').hide()" 
                                         update="frmPreguntas"
                                         icon="pi pi-save"/>
                        <p:spacer width="20" />
                       <p:commandButton value="Cancelar" styleClass="rounded-button"
                                        oncomplete="PF('dlgPregunta').hide()" 
                                        style="background-color: red"
                                         icon="pi pi-times"/>
                    </center>
                    
                </f:facet >

            </p:panelGrid>
        </h:form>
                  
    </p:dialog>
  

<p:dialog id="dlgRespuesta" widgetVar="dlgRespuesta" header="Respuestas "
        modal="true" width="80%">
    <h:form id="frmRespuesta">
        <p:panelGrid columns="3">
            <f:facet name='header'>
                     <h:panelGroup>
                    <p:outputLabel value="Pregunta '" style="float: left"/>
                    <p:outputLabel value=" #{preguntaMB.pregunta.pregunta}'" style="float: left"/>  
                </h:panelGroup> 
                </f:facet >
                
            <h:panelGroup>
                    <p:outputLabel value="Respuesta" style="float: left"/> 
                    <p:inputText value="#{preguntaMB.respuesta.respuesta}" style="width: 100%"/>
            </h:panelGroup>
                
            <h:panelGroup>
                    <p:outputLabel value="Usuario" style="float: left"/> 
                    <p:inputText value="#{preguntaMB.respuesta.usuarioRegistro}" style="width: 100%"/>
            </h:panelGroup> 
            <h:panelGroup>
                   <p:commandButton value="Registrar" styleClass="rounded-button"
                                         style="background-color: green"
                                         actionListener="#{preguntaMB.guardarRespuesta()}"
                                         update="dlgRespuesta, frmRespuestas,frmRespuesta"
                                         oncomplete="if (!args.validationFailed) { PF('dlgRespuesta').show(); }"
                                         icon="pi pi-save"/>
            </h:panelGroup> 
        </p:panelGrid>
    </h:form>
    
        <h:form id="frmRespuestas">
               <br></br>
            <p:dataTable id="dtRespuestas" value="#{preguntaMB.respuestas}" var="r">
                <p:column headerText="Respuesta">
                    #{r.respuesta}
                </p:column>
                <p:column headerText="Calificacion">
                    #{r.calificacion}
                </p:column>
                <p:column headerText="Usuario">
                    #{r.usuarioRegistro}
                </p:column>
                </p:dataTable>
        </h:form>
                  
    </p:dialog>


</html>
